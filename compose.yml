services:
  nginx:
    image: 'nginx:1.21.3'
    ports:
      - '${HTTP_BIND}:${HTTP_PORT}:80'
    volumes:
      - '/data/coolify/applications/tog8oo0sko0scw0g8c4ko0wk/.huly.nginx:/etc/nginx/conf.d/default.conf'
    restart: unless-stopped
    container_name: nginx-tog8oo0sko0scw0g8c4ko0wk-130703623237
    labels:
      - coolify.managed=true
      - coolify.version=4.0.0-beta.426
      - coolify.applicationId=44
      - coolify.type=application
      - coolify.name=nginx-tog8oo0sko0scw0g8c4ko0wk-130703623237
      - coolify.resourceName=hcengineeringhuly-selfhostmain-v0cs0ok84wckgosko40ok08w
      - coolify.projectName=theosirislabs
      - coolify.serviceName=hcengineeringhuly-selfhostmain-v0cs0ok84wckgosko40ok08w
      - coolify.environmentName=production
      - coolify.pullRequestId=0
      - traefik.enable=true
      - traefik.http.middlewares.gzip.compress=true
      - traefik.http.middlewares.redirect-to-https.redirectscheme.scheme=https
      - traefik.http.routers.http-0-tog8oo0sko0scw0g8c4ko0wk-nginx.entryPoints=http
      - traefik.http.routers.http-0-tog8oo0sko0scw0g8c4ko0wk-nginx.middlewares=redirect-to-https
      - 'traefik.http.routers.http-0-tog8oo0sko0scw0g8c4ko0wk-nginx.rule=Host(`portal.theosirislabs.com`) && PathPrefix(`/`)'
      - traefik.http.routers.https-0-tog8oo0sko0scw0g8c4ko0wk-nginx.entryPoints=https
      - traefik.http.routers.https-0-tog8oo0sko0scw0g8c4ko0wk-nginx.middlewares=gzip
      - 'traefik.http.routers.https-0-tog8oo0sko0scw0g8c4ko0wk-nginx.rule=Host(`portal.theosirislabs.com`) && PathPrefix(`/`)'
      - traefik.http.routers.https-0-tog8oo0sko0scw0g8c4ko0wk-nginx.tls.certresolver=letsencrypt
      - traefik.http.routers.https-0-tog8oo0sko0scw0g8c4ko0wk-nginx.tls=true
    networks:
      tog8oo0sko0scw0g8c4ko0wk: null

  cockroach:
    image: 'cockroachdb/cockroach:latest-v24.2'
    command: 'start-single-node --accept-sql-without-tls'
    environment:
      COCKROACH_DATABASE: '${CR_DATABASE}'
      COCKROACH_USER: '${CR_USERNAME}'
      COCKROACH_PASSWORD: '${CR_USER_PASSWORD}'
    volumes:
      - 'tog8oo0sko0scw0g8c4ko0wk_cr-data:/cockroach/cockroach-data'
      - 'tog8oo0sko0scw0g8c4ko0wk_cr-certs:/cockroach/certs'
    restart: unless-stopped

  redpanda:
    image: 'docker.redpanda.com/redpandadata/redpanda:v24.3.6'
    command:
      - redpanda
      - start
      - '--kafka-addr internal://0.0.0.0:9092,external://0.0.0.0:19092'
      - '--advertise-kafka-addr internal://redpanda:9092,external://localhost:19092'
      - '--pandaproxy-addr internal://0.0.0.0:8082,external://0.0.0.0:18082'
      - '--advertise-pandaproxy-addr internal://redpanda:8082,external://localhost:18082'
      - '--schema-registry-addr internal://0.0.0.0:8081,external://0.0.0.0:18081'
      - '--rpc-addr redpanda:33145'
      - '--advertise-rpc-addr redpanda:33145'
      - '--mode dev-container'
      - '--smp 1'
      - '--default-log-level=info'
    volumes:
      - 'tog8oo0sko0scw0g8c4ko0wk_redpanda:/var/lib/redpanda/data'
    restart: unless-stopped

  minio:
    image: 'minio/minio:latest'
    command: 'server /data --address ":9000" --console-address ":9001"'
    volumes:
      - 'tog8oo0sko0scw0g8c4ko0wk_files:/data'
    restart: unless-stopped

  elastic:
    image: 'docker.elastic.co/elasticsearch/elasticsearch:7.17.9'
    environment:
      discovery.type: single-node
      ES_JAVA_OPTS: '-Xms1024m -Xmx1024m'
    volumes:
      - 'tog8oo0sko0scw0g8c4ko0wk_elastic:/usr/share/elasticsearch/data'
    restart: unless-stopped

  rekoni:
    image: 'hardcoreeng/rekoni-service:v0.7.242'
    restart: unless-stopped

  transactor:
    image: 'hardcoreeng/transactor:v0.7.242'
    restart: unless-stopped

  collaborator:
    image: 'hardcoreeng/collaborator:v0.7.242'
    restart: unless-stopped

  account:
    image: 'hardcoreeng/account:v0.7.242'
    restart: unless-stopped

  workspace:
    image: 'hardcoreeng/workspace:v0.7.242'
    restart: unless-stopped

  front:
    image: 'hardcoreeng/front:v0.7.242'
    restart: unless-stopped

  fulltext:
    image: 'hardcoreeng/fulltext:v0.7.242'
    restart: unless-stopped

  stats:
    image: 'hardcoreeng/stats:v0.7.242'
    restart: unless-stopped

volumes:
  tog8oo0sko0scw0g8c4ko0wk_cr-data:
  tog8oo0sko0scw0g8c4ko0wk_cr-certs:
  tog8oo0sko0scw0g8c4ko0wk_redpanda:
  tog8oo0sko0scw0g8c4ko0wk_files:
  tog8oo0sko0scw0g8c4ko0wk_elastic:

networks:
  tog8oo0sko0scw0g8c4ko0wk:
    external: true
